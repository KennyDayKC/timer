<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Timer Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@700&display=swap');
        body { background: black; font-family: 'JetBrains Mono', monospace; color: white; overflow: hidden; }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body class="h-screen flex items-center justify-center transition-colors duration-500" id="bg">
    <div class="text-center w-full px-4">
        <div id="status" class="mb-4 text-xl font-bold tracking-widest text-white/50 h-8"></div>
        
        <div id="display" class="text-[22vw] leading-none font-bold tabular-nums cursor-pointer select-none">10:00</div>
        
        <div class="mt-10 flex justify-center items-center gap-8 opacity-20 hover:opacity-100 transition-opacity">
            <button onclick="reset()" class="p-3 hover:bg-white/10 rounded-full">ğŸ”„ é‡è¨­</button>
            <button id="startBtn" onclick="toggle()" class="px-8 py-3 bg-white text-black rounded-full font-black text-xl">START</button>
            <button onclick="openSettings()" class="p-3 hover:bg-white/10 rounded-full">âš™ï¸ è¨­å®š</button>
        </div>
    </div>

    <div id="modal" class="hidden fixed inset-0 bg-black/95 flex items-center justify-center p-6">
        <div class="bg-zinc-900 p-8 rounded-3xl border border-white/10 w-full max-w-sm">
            <h3 class="text-xl mb-6 font-bold">è¨­å®šæ™‚é–“ (åˆ†é˜)</h3>
            <input type="number" id="minInput" value="10" class="w-full bg-zinc-800 p-4 rounded-xl text-2xl mb-6 outline-none border border-white/10">
            <button onclick="saveSettings()" class="w-full py-4 bg-green-500 text-black font-bold rounded-xl">å¥—ç”¨ä¸¦é‡è¨­</button>
        </div>
    </div>

    <script>
        let timeLeft = 600;
        let timer = null;
        let isRunning = false;
        let audioCtx = null;

        const display = document.getElementById('display');
        const startBtn = document.getElementById('startBtn');
        const bg = document.getElementById('bg');
        const status = document.getElementById('status');

        function playBeep(freq) {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5);
            osc.start(); osc.stop(audioCtx.currentTime + 0.5);
        }

        function updateDisplay() {
            const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
            const s = (timeLeft % 60).toString().padStart(2, '0');
            display.innerText = `${m}:${s}`;
            
            // è®Šè‰²é‚è¼¯
            if (timeLeft === 900) { alertTrigger("å‰©é¤˜ 15 åˆ†é˜", "bg-amber-600", 660); }
            if (timeLeft === 300) { alertTrigger("å‰©é¤˜ 5 åˆ†é˜", "bg-orange-700", 880); }
            if (timeLeft === 0) { alertTrigger("æ™‚é–“åˆ°ï¼", "bg-red-600", 440); clearInterval(timer); }
        }

        function alertTrigger(msg, color, freq) {
            status.innerText = msg;
            bg.className = `h-screen flex items-center justify-center transition-colors duration-500 ${color}`;
            playBeep(freq);
            setTimeout(() => { 
                if (timeLeft > 0) { bg.className = "h-screen flex items-center justify-center bg-black"; status.innerText = ""; }
            }, 3000);
        }

        function toggle() {
            if (isRunning) {
                clearInterval(timer);
                startBtn.innerText = "START";
                startBtn.className = "px-8 py-3 bg-green-500 text-white rounded-full font-black text-xl";
            } else {
                if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
                timer = setInterval(() => { if(timeLeft > 0) { timeLeft--; updateDisplay(); } }, 1000);
                startBtn.innerText = "PAUSE";
                startBtn.className = "px-8 py-3 bg-white text-black rounded-full font-black text-xl";
            }
            isRunning = !isRunning;
        }

        function reset() {
            clearInterval(timer);
            isRunning = false;
            timeLeft = document.getElementById('minInput').value * 60;
            startBtn.innerText = "START";
            bg.className = "h-screen flex items-center justify-center bg-black";
            status.innerText = "";
            updateDisplay();
        }

        function openSettings() { document.getElementById('modal').classList.remove('hidden'); }
        function saveSettings() { 
            document.getElementById('modal').classList.add('hidden');
            reset();
        }

        updateDisplay();
    </script>
</body>
</html>
